{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { authService } from '../../auth/authService';\nimport BasicLogin from './BasicLogin';\nimport MFAStep from './MFAStep';\nimport './Login.css';\nvar Login = function Login() {\n  var navigate = useNavigate();\n  var _useState = useState('basic'),\n    _useState2 = _slicedToArray(_useState, 2),\n    loginType = _useState2[0],\n    setLoginType = _useState2[1]; // 'basic', 'mfa'\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    username = _useState4[0],\n    setUsername = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    mfaToken = _useState6[0],\n    setMfaToken = _useState6[1];\n  var _useState7 = useState(false),\n    _useState8 = _slicedToArray(_useState7, 2),\n    isLoading = _useState8[0],\n    setIsLoading = _useState8[1];\n  var _useState9 = useState(''),\n    _useState0 = _slicedToArray(_useState9, 2),\n    error = _useState0[0],\n    setError = _useState0[1];\n\n  // Verificar si estamos en WebView de Windows\n  var isWebView = authService.isWindowsWebView();\n  useEffect(function () {\n    // Si estamos en WebView, log para debugging\n    if (isWebView) {\n      console.log('Modo WebView detectado - Compatible con MDM enrollment');\n    }\n  }, [isWebView]);\n  var handleBasicLogin = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email, password) {\n      var result, _result$data, _t;\n      return _regeneratorRuntime.wrap(function (_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            setIsLoading(true);\n            setError('');\n            _context.prev = 1;\n            _context.next = 2;\n            return authService.basicLogin(email, password);\n          case 2:\n            result = _context.sent;\n            if (result.success) {\n              // Verificar si requiere MFA\n              if ((_result$data = result.data) !== null && _result$data !== void 0 && _result$data.requiresMFA) {\n                setMfaToken(result.data.mfaToken);\n                setUsername(email);\n                setLoginType('mfa');\n              } else {\n                navigate('/dashboard');\n              }\n            } else {\n              setError(result.error || 'Error en el login');\n            }\n            _context.next = 4;\n            break;\n          case 3:\n            _context.prev = 3;\n            _t = _context[\"catch\"](1);\n            setError('Error al iniciar sesi√≥n. Por favor, intenta de nuevo.');\n          case 4:\n            _context.prev = 4;\n            setIsLoading(false);\n            return _context.finish(4);\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[1, 3, 4, 5]]);\n    }));\n    return function handleBasicLogin(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var handleMFASuccess = function handleMFASuccess() {\n    navigate('/dashboard');\n  };\n  var handleMFACancel = function handleMFACancel() {\n    setLoginType('basic');\n    setMfaToken(null);\n  };\n  var renderLoginContent = function renderLoginContent() {\n    if (loginType === 'mfa') {\n      return /*#__PURE__*/React.createElement(MFAStep, {\n        username: username,\n        mfaToken: mfaToken,\n        onSuccess: handleMFASuccess,\n        onCancel: handleMFACancel\n      });\n    }\n    return /*#__PURE__*/React.createElement(BasicLogin, {\n      onSubmit: handleBasicLogin,\n      isLoading: isLoading,\n      error: error\n    });\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-container\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-card\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-header\"\n  }, /*#__PURE__*/React.createElement(\"h1\", null, \"MDM Enrollment\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"login-subtitle\"\n  }, \"Inicia sesi\\xF3n para continuar con el enrollment\")), error && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"error-message\"\n  }, error), renderLoginContent(), isWebView && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"webview-notice\"\n  }, /*#__PURE__*/React.createElement(\"p\", null, \"Modo WebView detectado - Compatible con MDM enrollment\"))));\n};\nexport default Login;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}